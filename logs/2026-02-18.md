# 2026-02-18 - Initial Build

## Goals
- Build an English learning browser extension
- Select/click words to get definitions and save them

## Decisions

### Tech Stack
- Plain JavaScript with JSDoc (no TypeScript, no build step)
- CSS for styling
- Manifest V3 for Chrome/Firefox compatibility
- Free Dictionary API (no API key required)

### Key Technologies Adopted
- **Popover API**: Native browser popup with light dismiss (no manual click/escape handlers)
- **CSS Anchor Positioning**: Position popup relative to highlighted text with automatic viewport collision handling

## Actions

### Project Setup
- Created `SPEC.md` with feature specification and implementation plan
- Created `manifest.json` for MV3
- Set up directory structure: `popup/`, `icons/`

### Core Implementation
- Built content script (`venustum_content.js`)
  - Text selection detection (mouseup + debounce)
  - Double-click word detection
  - Sentence extraction algorithm
  - Highlighting with anchor-name for CSS positioning
  - Popup UI with definition display and save functionality
- Built background script (`venustum_background.js`)
  - Dictionary API client
  - Storage operations (save/get/delete entries)
  - Badge count updates
- Built popup UI (`popup/`)
  - View saved entries
  - Delete entries
  - Open source URL
- Created placeholder icons

### Refactoring
1. Extracted inline styles to `venustum_content.css`
2. Adopted Popover API - removed manual positioning and event handlers
3. Adopted CSS Anchor Positioning - replaced JS `positionPopup()` with CSS
4. Deduplicated popup styles (`.venustum-popup` and `.venustum-popup-fallback`)
5. Added margin between anchor and popup using `margin-block: 8px`

### Style Adjustments
- Fixed close button text visibility (added `color: #333`)
- Changed disabled button style from green to gray
- Removed `cursor: pointer` from buttons

### Repo Setup
- Generated proper UUID for Firefox extension ID
- Updated minimum Firefox version to 125.0 (for Popover API support)
- Created GitHub repo: https://github.com/myakura/venustum

## Commits

| Commit | Description |
|--------|-------------|
| `Initial commit: add project spec` | SPEC.md and .editorconfig |
| `Implement extension core functionality` | All extension files |
| `Extract content script styles to separate CSS file` | CSS refactoring |
| `Fix close button text visibility` | Button color fix |
| `Use native Popover API for popup` | Popover API adoption |
| `Update minimum Firefox version to 125 for Popover API` | Version bump |
| `Use proper UUID for Firefox extension ID` | UUID fix |
| `Use CSS anchor positioning for popup placement` | Anchor positioning |
| `Fix missing hidePopup function` | Bug fix |
| `Deduplicate popup styles in CSS` | CSS cleanup |
| `Add margin between anchor and popup` | Spacing fix |
| `Use gray style for disabled save button` | Style change |
| `Remove cursor declarations from buttons` | Style cleanup |
| `Update minimum Firefox version to 147 for CSS Anchor Positioning` | Version requirement fix |

## Current Version
`0.2.2`
